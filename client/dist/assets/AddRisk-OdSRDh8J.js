import{u as ce,r as a,a as ne,j as e,c as Z,b as de}from"./index-C07UJA1Y.js";import{J as me,u as ue}from"./useJoditConfig-Bj6tcPm_.js";import{B as i,H as o}from"./react-tooltip.min-D1sjDDzu.js";import{S as l}from"./index-CzlzJ9GH.js";import{R as pe}from"./index.esm-zaRqswlb.js";import{C as xe,a as fe}from"./CustomOption-CgQ-oymv.js";const ve=()=>{const d=ce(),{risksDataRefeatch:ee,projectsData:se}=a.useContext(ne),c=window.location.href.split("/")[8],m=window.location.href.split("/")[6],t=se.find(s=>s._id==c),u=a.useRef(null),p=a.useRef(null),x=a.useRef(null),f=a.useRef(null),h=a.useRef(null),j=a.useRef(null),b=a.useRef(null),[re,g]=a.useState(0),[te,k]=a.useState(!1),w=[`https://logify-task.onrender.com/public/uploads/${t.risk_matrix_template}`],ae=a.useCallback(s=>{g(s),k(!0)},[]),le=()=>{g(0),k(!1)},ie=s=>{var q,O,B,V,z,M,$,P,A,H,J,W,G,L,T,Y,K,Q,U,X;s.preventDefault();const r=(O=(q=s.target)==null?void 0:q.riskName)==null?void 0:O.value,v=(V=(B=s.target)==null?void 0:B.riskDescription)==null?void 0:V.value,N=(M=(z=s.target)==null?void 0:z.riskEffect)==null?void 0:M.value,y=t.risk_matrix_template,C=(P=($=s.target)==null?void 0:$.riskCause)==null?void 0:P.value,R=(H=(A=p.current.state)==null?void 0:A.prevProps)==null?void 0:H.value,_=(W=(J=x.current.state)==null?void 0:J.prevProps)==null?void 0:W.value,D=(L=(G=b.current.state)==null?void 0:G.prevProps)==null?void 0:L.value,F=(Y=(T=f.current.state)==null?void 0:T.prevProps)==null?void 0:Y.value,I=(Q=(K=h.current.state)==null?void 0:K.prevProps)==null?void 0:Q.value,S=(X=(U=j.current.state)==null?void 0:U.prevProps)==null?void 0:X.value,E=u.current.value;if(!r||!v||!N||!y||!C||!_||!R||!D||!F||!I||!S||!E){Z("Some data is messing!","warning");return}const oe={risk_category:_,risk_name:r,risk_description:v,risk_cause:C,risk_owner:R,risk_effect:N,consequences:D,risk_consequences_impact:F,likelihood:I,ratting:S,comment:E,risk_matrix_template:y,project_id:c,status:m};de.post("/risks_api/add-risk",oe).then(n=>{n.status==200&&(ee(),d(`/ projects / logs / risk / ${m} / ${c}`),Z("Added Successfully Risk","success"))}).catch(n=>console.log(n))};return e.jsx("div",{className:"w-full py-10",children:e.jsxs("form",{onSubmit:ie,className:"flex w-[60%] mx-auto flex-col",children:[e.jsxs("div",{className:"flex w-full items-center mb-6",children:[e.jsxs("div",{className:"w-[30%] flex items-center gap-2",children:[e.jsx("label",{htmlFor:"",children:"Risk Category"}),e.jsx("div",{"data-tooltip-id":"risk-category",className:"bg-[#aaaaaa] hover:bg-[#4B5563] rounded-full text-white mt-1 cursor-pointer",children:e.jsx(i,{})}),e.jsx(o,{id:"risk-category",content:"Enter generic risk categories to allow grouping of risk, For example, 'Construction, Design, Schedule, Environmental etc, 'corporate construction or other generic items, You can always add more categories in your project page. ",style:{width:"350px"},className:"tooltip-style",place:"right"})]}),e.jsx(l,{ref:x,className:"w-[70%] ",options:t==null?void 0:t.risk_categories,isClearable:!0,styles:{control:(s,r)=>({...s,borderColor:(r.isFocused,"#4256D0"),padding:"6px"})}})]}),e.jsxs("div",{className:"flex w-full items-center mb-6",children:[e.jsxs("div",{className:"w-[30%]  flex items-center gap-2",children:[e.jsx("label",{htmlFor:"",children:"Risk Name"}),e.jsx("div",{"data-tooltip-id":"risk-name",className:"bg-[#aaaaaa] hover:bg-[#4B5563] rounded-full text-white mt-1 cursor-pointer",children:e.jsx(i,{})}),e.jsx(o,{id:"risk-name",content:"High level description of the risk, for example 'Fall Hazard'. ",style:{width:"350px"},place:"right"})]}),e.jsx("input",{placeholder:"Enter risk name",name:"riskName",id:"riskName",className:"border-primary border w-[70%] p-3 rounded outline-none ",type:"text"})]}),e.jsxs("div",{className:"flex w-full items-center mb-6",children:[e.jsxs("div",{className:"w-[30%]  flex items-center gap-2",children:[e.jsx("label",{htmlFor:"",children:"Risk Description"}),e.jsx("div",{"data-tooltip-id":"risk-description",className:"bg-[#aaaaaa] hover:bg-[#4B5563] rounded-full text-white mt-1 cursor-pointer",children:e.jsx(i,{})}),e.jsx(o,{id:"risk-description",content:"Detailed description of risk, for example 'Falling into open pit'.",style:{width:"350px"},place:"right"})]}),e.jsx("textarea",{className:"border-primary border w-[70%] p-3 rounded outline-none",name:"riskDescription",id:"riskDescription",cols:"10",rows:"4",placeholder:"Write risk description"})]}),e.jsxs("div",{className:"flex w-full items-center mb-6",children:[e.jsxs("div",{className:"w-[30%]  flex items-center gap-2",children:[e.jsx("label",{htmlFor:"",children:"Risk Cause"}),e.jsx("div",{"data-tooltip-id":"risk-cause",className:"bg-[#aaaaaa] hover:bg-[#4B5563] rounded-full text-white mt-1 cursor-pointer",children:e.jsx(i,{})}),e.jsx(o,{id:"risk-cause",content:"Provide details of what could be the cause of the impact, for example 'No barrier or fence around the open pit'.",style:{width:"350px"},place:"right"})]}),e.jsx("textarea",{className:"border-primary border w-[70%] p-3 rounded outline-none",name:"riskCause",id:"riskCause",cols:"10",rows:"4",placeholder:"Write risk cause"})]}),e.jsxs("div",{className:"flex w-full items-center mb-6",children:[e.jsx("label",{className:"w-[30%]",htmlFor:"",children:"Risk Owner"}),e.jsx(l,{ref:p,className:"w-[70%] z-[50]",options:t==null?void 0:t.project_owner,components:{MultiValue:xe,Option:fe},isClearable:!0,isMulti:!0,styles:{control:(s,r)=>({...s,borderColor:(r.isFocused,"#4256D0"),padding:"6px"})}})]}),e.jsxs("div",{className:"flex w-full items-center mb-6",children:[e.jsxs("div",{className:"w-[30%]  flex items-center gap-2",children:[e.jsx("label",{htmlFor:"",children:"Risk Effect"}),e.jsx("div",{"data-tooltip-id":"risk-effect",className:"bg-[#aaaaaa] hover:bg-[#4B5563] rounded-full text-white mt-1 cursor-pointer",children:e.jsx(i,{})}),e.jsx(o,{id:"risk-effect",content:"Describe the effect of the risk, 'For example 'Causing serious injury or death'.",style:{width:"350px"},place:"right"})]}),e.jsx("input",{placeholder:"Enter control name",name:"riskEffect",id:"riskEffect",className:"border-primary border w-[70%] p-3 rounded outline-none",type:"text"})]}),e.jsxs("div",{className:"flex w-full items-center mb-6",children:[e.jsx("label",{className:"w-[30%]",htmlFor:"",children:"Consequences"}),e.jsxs("div",{className:"flex w-[70%] gap-4 items-center ",children:[e.jsx(l,{ref:b,className:"w-[70%] z-[40]",options:t.risk_consequences,isClearable:!0,placeholder:"Consequence",styles:{control:(s,r)=>({...s,borderColor:(r.isFocused,"#4256D0"),padding:"6px"})}}),e.jsx(l,{ref:f,className:"w-[70%] z-[40]",options:t.risk_consequences_impact,isClearable:!0,placeholder:"Impact",styles:{control:(s,r)=>({...s,borderColor:(r.isFocused,"#4256D0"),padding:"6px"})}})]})]}),e.jsxs("div",{className:"flex w-full items-center mb-6",children:[e.jsx("label",{className:"w-[30%]",htmlFor:"",children:"Risk Rating"}),e.jsx("div",{className:"w-[70%]",children:e.jsxs("div",{className:"flex  gap-4",children:[e.jsx(l,{ref:h,className:"w-[70%] ",options:t.likelihood,isClearable:!0,placeholder:"Likelihood",styles:{control:(s,r)=>({...s,borderColor:(r.isFocused,"#4256D0"),padding:"6px"})}}),"      ",e.jsx(l,{ref:j,className:"w-[70%] ",options:t.risk_ratting,isClearable:!0,placeholder:"Ratting",styles:{control:(s,r)=>({...s,borderColor:(r.isFocused,"#4256D0"),padding:"6px"})}})]})})]}),e.jsxs("div",{className:"flex w-full items-center mb-6",children:[e.jsx("label",{className:"w-[30%]",htmlFor:"",children:"Comment"}),e.jsx("div",{className:"w-[70%] border border-primary rounded",children:e.jsx(me,{ref:u,config:ue,tabIndex:1})})]}),e.jsxs("div",{className:"flex w-full items-center mb-6",children:[e.jsx("label",{className:"w-[30%]",htmlFor:"",children:"Risk Matrix Template"}),e.jsx("div",{className:"w-[70%] border border-primary rounded",children:e.jsxs("div",{children:[w.map((s,r)=>e.jsx("img",{src:s,onClick:()=>ae(r),className:"w-full h-[500px] object-cover rounded",alt:""},r)),te&&e.jsx("div",{className:"z-[100]",children:e.jsx(pe,{src:w,currentIndex:re,disableScroll:!1,closeOnClickOutside:!0,onClose:le})})]})})]}),e.jsxs("div",{className:"flex w-full items-center mb-6",children:[e.jsx("label",{className:"w-[30%]",htmlFor:""}),e.jsxs("div",{className:"w-[70%] flex gap-8",children:[e.jsx("button",{className:"bg-primary py-3 w-full text-white rounded-lg",children:"Add Risk"}),e.jsx("button",{type:"button",onClick:()=>d("/projects/logs/control/open/add-control/456465"),className:"border border-primary text-primary py-3 w-full rounded-lg",children:"Cancel"})]})]})]})})};export{ve as default};
